<!-- views/entreprises/edit.ejs -->
<%- contentFor('head') %>
<style>
    :root {
        --primary-pink: #e7a6b7;
        --primary-blue: #a5bfd4;
        --light-pink: #fce8ec;
        --light-blue: #e8f3f8;
        --soft-gray: #f5f5f7;
        --text-dark: #2f2f2f;
        --text-light: #6f6f6f;
        --white: #ffffff;
        --gradient-contact: linear-gradient(135deg, #e7a6b7, #a5bfd4);
        --danger: #ff6b6b;
        --warning: #ff9f80;
        --success: #9dd6b5;
    }

    .page-header {
        background: var(--gradient-contact);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 25px 25px;
    }

    .form-container {
        background: var(--white);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        padding: 2rem;
        max-width: 900px;
        margin: 0 auto;
    }

    .form-section {
        margin-bottom: 3rem;
        padding-bottom: 2rem;
        border-bottom: 2px solid var(--soft-gray);
    }

    .form-section:last-child {
        border-bottom: none;
        margin-bottom: 0;
    }

    .section-title {
        font-size: 1.4rem;
        font-weight: 600;
        color: var(--primary-blue);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .form-row.single {
        grid-template-columns: 1fr;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    .form-label {
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
    }

    .form-label.required::after {
        content: ' *';
        color: var(--danger);
    }

    .form-control {
        padding: 0.875rem 1rem;
        border: 2px solid var(--soft-gray);
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: var(--white);
    }

    .form-control:focus {
        outline: none;
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 3px rgba(165, 191, 212, 0.1);
    }

    .form-control.error {
        border-color: var(--danger);
        background: #fff5f5;
    }

    .error-message {
        color: var(--danger);
        font-size: 0.85rem;
        margin-top: 0.5rem;
    }

    .form-help {
        font-size: 0.85rem;
        color: var(--text-light);
        margin-top: 0.3rem;
    }

    .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1rem;
    }

    .btn-primary {
        background: var(--gradient-contact);
        color: white;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(231, 166, 183, 0.3);
    }

    .btn-secondary {
        background: var(--soft-gray);
        color: var(--text-dark);
    }

    .btn-warning {
        background: var(--warning);
        color: white;
    }

    .btn-danger {
        background: var(--danger);
        color: white;
    }

    .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 2px solid var(--soft-gray);
    }

    .input-group {
        position: relative;
    }

    .input-group-text {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-light);
        font-size: 1.1rem;
        pointer-events: none;
    }

    .input-group .form-control {
        padding-left: 3rem;
    }

    .status-section {
        background: var(--light-blue);
        border: 2px solid var(--primary-blue);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }

    .status-current {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.9rem;
    }

    .status-actif {
        background: var(--success);
        color: white;
    }

    .status-en_attente {
        background: var(--warning);
        color: white;
    }

    .status-suspendu {
        background: var(--danger);
        color: white;
    }

    .licences-info {
        background: var(--light-pink);
        border: 2px solid var(--primary-pink);
        border-radius: 10px;
        padding: 1rem;
        margin-top: 1rem;
    }

    .warning-box {
        background: rgba(255, 159, 128, 0.1);
        border: 2px solid var(--warning);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }
        
        .form-container {
            padding: 1.5rem;
            margin: 0 1rem;
        }
        
        .form-actions {
            flex-direction: column;
        }
    }
</style>

<div class="page-header">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="mb-2">Modifier l'entreprise</h1>
                <p class="mb-0 opacity-90"><%= entreprise.nom %> - SIRET <%= entreprise.siret %></p>
            </div>
            <div class="d-flex gap-2">
                <a href="/entreprises/<%= entreprise.id %>" class="btn btn-light">
                    ‚Üê Retour aux d√©tails
                </a>
                <a href="/entreprises" class="btn btn-light">
                    üìã Liste entreprises
                </a>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <form action="/entreprises/<%= entreprise.id %>" method="POST" class="form-container" id="entrepriseEditForm">
        
        <!-- Statut actuel -->
        <div class="status-section">
            <h3 style="color: var(--primary-blue); margin-bottom: 1rem;">üìä Statut actuel</h3>
            <div class="status-current">
                <span>Statut :</span>
                <span class="status-badge status-<%= entreprise.statut %>">
                    <%= entreprise.statut.replace('_', ' ') %>
                </span>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="statut" class="form-label">Changer le statut</label>
                    <select id="statut" name="statut" class="form-control">
                        <option value="en_attente" <%= entreprise.statut === 'en_attente' ? 'selected' : '' %>>En attente</option>
                        <option value="actif" <%= entreprise.statut === 'actif' ? 'selected' : '' %>>Actif</option>
                        <option value="suspendu" <%= entreprise.statut === 'suspendu' ? 'selected' : '' %>>Suspendu</option>
                        <option value="inactif" <%= entreprise.statut === 'inactif' ? 'selected' : '' %>>Inactif</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="motif_changement" class="form-label">Motif du changement</label>
                    <input type="text" id="motif_changement" name="motif_changement" class="form-control" 
                           placeholder="Indiquez pourquoi vous modifiez le statut...">
                </div>
            </div>
        </div>

        <!-- Licences et contrat - Info importante -->
        <% if (entreprise.nombre_licences_utilisees > 0) { %>
            <div class="warning-box">
                <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
                <div>
                    <strong>Attention :</strong> Cette entreprise a actuellement <%= entreprise.nombre_licences_utilisees %> licence(s) utilis√©e(s).
                    <br>R√©duire le nombre de licences maximum pourrait affecter l'acc√®s des utilisateurs.
                </div>
            </div>
        <% } %>

        <!-- Informations g√©n√©rales -->
        <div class="form-section">
            <h3 class="section-title">
                üè¢ Informations g√©n√©rales
            </h3>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="nom" class="form-label required">Nom de l'entreprise</label>
                    <input type="text" id="nom" name="nom" class="form-control <%= errors?.nom ? 'error' : '' %>" 
                           value="<%= entreprise.nom %>" required maxlength="255">
                    <% if (errors?.nom) { %>
                        <div class="error-message">‚ö†Ô∏è <%= errors.nom %></div>
                    <% } %>
                </div>
                
                <div class="form-group">
                    <label for="siret" class="form-label required">Num√©ro SIRET</label>
                    <div class="input-group">
                        <span class="input-group-text">üèõÔ∏è</span>
                        <input type="text" id="siret" name="siret" class="form-control <%= errors?.siret ? 'error' : '' %>" 
                               value="<%= entreprise.siret %>" required maxlength="14" pattern="[0-9]{14}">
                    </div>
                    <div class="form-help">14 chiffres sans espaces</div>
                    <% if (errors?.siret) { %>
                        <div class="error-message">‚ö†Ô∏è <%= errors.siret %></div>
                    <% } %>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="secteur_activite" class="form-label required">Secteur d'activit√©</label>
                    <select id="secteur_activite" name="secteur_activite" class="form-control" required>
                        <option value="aide_domicile" <%= entreprise.secteur_activite === 'aide_domicile' ? 'selected' : '' %>>Aide √† domicile</option>
                        <option value="ehpad" <%= entreprise.secteur_activite === 'ehpad' ? 'selected' : '' %>>EHPAD</option>
                        <option value="hopital" <%= entreprise.secteur_activite === 'hopital' ? 'selected' : '' %>>H√¥pital</option>
                        <option value="clinique" <%= entreprise.secteur_activite === 'clinique' ? 'selected' : '' %>>Clinique</option>
                        <option value="centre_soins" <%= entreprise.secteur_activite === 'centre_soins' ? 'selected' : '' %>>Centre de soins</option>
                        <option value="autre" <%= entreprise.secteur_activite === 'autre' ? 'selected' : '' %>>Autre</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="nombre_employes" class="form-label">Nombre d'employ√©s</label>
                    <div class="input-group">
                        <span class="input-group-text">üë•</span>
                        <input type="number" id="nombre_employes" name="nombre_employes" class="form-control" 
                               value="<%= entreprise.nombre_employes || '' %>" min="1">
                    </div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label for="description" class="form-label">Description</label>
                    <textarea id="description" name="description" class="form-control" rows="3" 
                              placeholder="D√©crivez bri√®vement l'entreprise et ses activit√©s..."><%= entreprise.description || '' %></textarea>
                </div>
            </div>
        </div>

        <!-- Configuration contrat -->
        <div class="form-section">
            <h3 class="section-title">
                üìã Configuration du contrat
            </h3>
            
            <div class="licences-info">
                <strong>√âtat actuel des licences :</strong>
                <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                    <li><%= entreprise.nombre_licences_utilisees %> licence(s) actuellement utilis√©e(s)</li>
                    <li><%= entreprise.nombre_licences_max - entreprise.nombre_licences_utilisees %> licence(s) disponible(s)</li>
                    <li>Taux d'utilisation : <%= Math.round((entreprise.nombre_licences_utilisees / entreprise.nombre_licences_max) * 100) %>%</li>
                </ul>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="type_contrat" class="form-label required">Type de contrat</label>
                    <select id="type_contrat" name="type_contrat" class="form-control" required>
                        <option value="standard" <%= entreprise.type_contrat === 'standard' ? 'selected' : '' %>>Standard</option>
                        <option value="premium" <%= entreprise.type_contrat === 'premium' ? 'selected' : '' %>>Premium</option>
                        <option value="enterprise" <%= entreprise.type_contrat === 'enterprise' ? 'selected' : '' %>>Enterprise</option>
                        <option value="personnalise" <%= entreprise.type_contrat === 'personnalise' ? 'selected' : '' %>>Personnalis√©</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="nombre_licences_max" class="form-label required">Nombre de licences maximum</label>
                    <div class="input-group">
                        <span class="input-group-text">üé´</span>
                        <input type="number" id="nombre_licences_max" name="nombre_licences_max" 
                               class="form-control" value="<%= entreprise.nombre_licences_max %>" 
                               required min="<%= entreprise.nombre_licences_utilisees %>" max="1000">
                    </div>
                    <div class="form-help">Minimum : <%= entreprise.nombre_licences_utilisees %> (licences d√©j√† utilis√©es)</div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="tarif_mensuel" class="form-label">Tarif mensuel (‚Ç¨)</label>
                    <div class="input-group">
                        <span class="input-group-text">üí∞</span>
                        <input type="number" id="tarif_mensuel" name="tarif_mensuel" class="form-control" 
                               value="<%= entreprise.tarif_mensuel || '' %>" min="0" step="0.01">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="reduction_pourcentage" class="form-label">R√©duction (%)</label>
                    <div class="input-group">
                        <span class="input-group-text">üè∑Ô∏è</span>
                        <input type="number" id="reduction_pourcentage" name="reduction_pourcentage" 
                               class="form-control" value="<%= entreprise.reduction_pourcentage || 0 %>" 
                               min="0" max="100" step="0.01">
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="date_debut_contrat" class="form-label">Date de d√©but</label>
                    <input type="date" id="date_debut_contrat" name="date_debut_contrat" class="form-control" 
                           value="<%= entreprise.date_debut_contrat ? entreprise.date_debut_contrat.toISOString().split('T')[0] : '' %>">
                </div>
                
                <div class="form-group">
                    <label for="date_fin_contrat" class="form-label">Date de fin</label>
                    <input type="date" id="date_fin_contrat" name="date_fin_contrat" class="form-control" 
                           value="<%= entreprise.date_fin_contrat ? entreprise.date_fin_contrat.toISOString().split('T')[0] : '' %>">
                    <div class="form-help">Laissez vide pour un contrat illimit√©</div>
                </div>
            </div>
        </div>

        <!-- Informations de contact (section repliable) -->
        <div class="form-section">
            <h3 class="section-title">
                üìû Informations de contact
                <button type="button" class="btn btn-secondary btn-sm" onclick="toggleSection('contact-section')">
                    Modifier
                </button>
            </h3>
            
            <div id="contact-section" style="display: none;">
                <div class="form-row">
                    <div class="form-group">
                        <label for="email_contact" class="form-label required">Email de contact</label>
                        <div class="input-group">
                            <span class="input-group-text">üìß</span>
                            <input type="email" id="email_contact" name="email_contact" class="form-control <%= errors?.email_contact ? 'error' : '' %>" 
                                   value="<%= entreprise.email_contact %>" required>
                        </div>
                        <% if (errors?.email_contact) { %>
                            <div class="error-message">‚ö†Ô∏è <%= errors.email_contact %></div>
                        <% } %>
                    </div>
                    
                    <div class="form-group">
                        <label for="telephone" class="form-label">T√©l√©phone</label>
                        <div class="input-group">
                            <span class="input-group-text">üì±</span>
                            <input type="tel" id="telephone" name="telephone" class="form-control" 
                                   value="<%= entreprise.telephone || '' %>">
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="site_web" class="form-label">Site web</label>
                        <div class="input-group">
                            <span class="input-group-text">üåê</span>
                            <input type="url" id="site_web" name="site_web" class="form-control" 
                                   value="<%= entreprise.site_web || '' %>">
                        </div>
                    </div>
                    <div class="form-group"></div>
                </div>

                <!-- Personne de contact -->
                <h4 style="color: var(--primary-blue); margin: 2rem 0 1rem;">üë§ Personne de contact</h4>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="personne_contact_prenom" class="form-label required">Pr√©nom</label>
                        <input type="text" id="personne_contact_prenom" name="personne_contact_prenom" 
                               class="form-control" value="<%= entreprise.personne_contact_prenom %>" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="personne_contact_nom" class="form-label required">Nom</label>
                        <input type="text" id="personne_contact_nom" name="personne_contact_nom" 
                               class="form-control" value="<%= entreprise.personne_contact_nom %>" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="personne_contact_fonction" class="form-label">Fonction</label>
                        <input type="text" id="personne_contact_fonction" name="personne_contact_fonction" 
                               class="form-control" value="<%= entreprise.personne_contact_fonction || '' %>">
                    </div>
                    
                    <div class="form-group">
                        <label for="personne_contact_email" class="form-label required">Email personnel</label>
                        <div class="input-group">
                            <span class="input-group-text">üìß</span>
                            <input type="email" id="personne_contact_email" name="personne_contact_email" 
                                   class="form-control" value="<%= entreprise.personne_contact_email %>" required>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Adresse (section repliable) -->
        <div class="form-section">
            <h3 class="section-title">
                üìç Adresse
                <button type="button" class="btn btn-secondary btn-sm" onclick="toggleSection('adresse-section')">
                    Modifier
                </button>
            </h3>
            
            <div id="adresse-section" style="display: none;">
                <div class="form-row single">
                    <div class="form-group">
                        <label for="adresse" class="form-label required">Adresse compl√®te</label>
                        <textarea id="adresse" name="adresse" class="form-control" rows="2" required><%= entreprise.adresse %></textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="code_postal" class="form-label required">Code postal</label>
                        <div class="input-group">
                            <span class="input-group-text">üìÆ</span>
                            <input type="text" id="code_postal" name="code_postal" class="form-control" 
                                   value="<%= entreprise.code_postal %>" required pattern="[0-9]{5}" maxlength="5">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="ville" class="form-label required">Ville</label>
                        <input type="text" id="ville" name="ville" class="form-control" 
                               value="<%= entreprise.ville %>" required>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes internes -->
        <div class="form-section">
            <h3 class="section-title">
                üìù Notes internes
            </h3>
            
            <div class="form-row single">
                <div class="form-group">
                    <label for="notes_internes" class="form-label">Notes et commentaires internes</label>
                    <textarea id="notes_internes" name="notes_internes" class="form-control" rows="4" 
                              placeholder="Ajoutez des notes internes sur cette entreprise..."><%= entreprise.notes_internes || '' %></textarea>
                    <div class="form-help">Ces notes ne sont visibles que par l'√©quipe ADSIAM</div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="form-actions">
            <a href="/entreprises/<%= entreprise.id %>" class="btn btn-secondary">
                ‚úñÔ∏è Annuler
            </a>
            <button type="button" class="btn btn-warning" onclick="resetForm()">
                üîÑ R√©initialiser
            </button>
            <button type="submit" class="btn btn-primary">
                ‚úÖ Sauvegarder les modifications
            </button>
        </div>
    </form>
</div>

<%- contentFor('scripts') %>
<script>
// Toggle des sections
function toggleSection(sectionId) {
    const section = document.getElementById(sectionId);
    const isVisible = section.style.display !== 'none';
    section.style.display = isVisible ? 'none' : 'block';
}

// Auto-formatage SIRET
document.getElementById('siret').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 14) {
        value = value.substring(0, 14);
    }
    e.target.value = value;
});

// Validation du nombre de licences
document.getElementById('nombre_licences_max').addEventListener('change', function(e) {
    const current = parseInt(e.target.value);
    const used = <%= entreprise.nombre_licences_utilisees %>;
    
    if (current < used) {
        alert(`‚ö†Ô∏è Attention : Vous ne pouvez pas d√©finir moins de ${used} licences car ${used} sont d√©j√† utilis√©es.`);
        e.target.value = used;
    }
});

// Validation des dates
document.getElementById('date_fin_contrat').addEventListener('change', function(e) {
    const dateDebut = document.getElementById('date_debut_contrat').value;
    const dateFin = e.target.value;
    
    if (dateDebut && dateFin && new Date(dateFin) <= new Date(dateDebut)) {
        alert('‚ö†Ô∏è La date de fin doit √™tre post√©rieure √† la date de d√©but');
        e.target.value = '';
    }
});

// Configuration automatique selon le type de contrat
document.getElementById('type_contrat').addEventListener('change', function(e) {
    const typeContrat = e.target.value;
    const licencesInput = document.getElementById('nombre_licences_max');
    const tarifInput = document.getElementById('tarif_mensuel');
    const currentLicences = parseInt(licencesInput.value);
    const usedLicences = <%= entreprise.nombre_licences_utilisees %>;
    
    const configs = {
        'standard': { licences: Math.max(10, usedLicences), tarif: 150 },
        'premium': { licences: Math.max(25, usedLicences), tarif: 350 },
        'enterprise': { licences: Math.max(100, usedLicences), tarif: 1200 },
        'personnalise': { licences: currentLicences, tarif: tarifInput.value }
    };
    
    if (configs[typeContrat] && typeContrat !== 'personnalise') {
        if (confirm(`Appliquer la configuration ${typeContrat} ?\n\nLicences: ${configs[typeContrat].licences}\nTarif: ${configs[typeContrat].tarif}‚Ç¨`)) {
            licencesInput.value = configs[typeContrat].licences;
            tarifInput.value = configs[typeContrat].tarif;
        }
    }
});

// R√©initialiser le formulaire
function resetForm() {
    if (confirm('R√©initialiser tous les champs aux valeurs d\'origine ?')) {
        location.reload();
    }
}

// Validation en temps r√©el
const form = document.getElementById('entrepriseEditForm');
let formModified = false;

// D√©tecter les modifications
form.addEventListener('input', () => formModified = true);
form.addEventListener('change', () => formModified = true);

// Confirmation avant de quitter
window.addEventListener('beforeunload', function(e) {
    if (formModified) {
        e.preventDefault();
        e.returnValue = '';
    }
});

// Soumission du formulaire
form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Validation finale
    const licencesMax = parseInt(document.getElementById('nombre_licences_max').value);
    const licencesUsed = <%= entreprise.nombre_licences_utilisees %>;
    
    if (licencesMax < licencesUsed) {
        alert(`‚ùå Erreur : Le nombre maximum de licences (${licencesMax}) ne peut √™tre inf√©rieur au nombre utilis√© (${licencesUsed})`);
        return;
    }
    
    // D√©sactiver le bouton
    const submitBtn = form.querySelector('button[type="submit"]');
    submitBtn.disabled = true;
    submitBtn.innerHTML = '‚è≥ Sauvegarde en cours...';
    
    formModified = false;
    form.submit();
});

// V√©rification SIRET en temps r√©el (sauf si identique √† l'original)
let siretTimeout;
document.getElementById('siret').addEventListener('input', function(e) {
    const siret = e.target.value.replace(/\s/g, '');
    const originalSiret = '<%= entreprise.siret %>';
    
    clearTimeout(siretTimeout);
    
    if (siret.length === 14 && siret !== originalSiret) {
        siretTimeout = setTimeout(async () => {
            try {
                const response = await fetch(`/api/entreprises/check-siret?siret=${siret}`);
                const result = await response.json();
                
                if (!result.available) {
                    showFieldError(e.target, 'Ce num√©ro SIRET est d√©j√† enregistr√©');
                }
            } catch (error) {
                console.error('Erreur v√©rification SIRET:', error);
            }
        }, 500);
    }
});

function showFieldError(field, message) {
    field.classList.add('error');
    let errorDiv = field.parentNode.querySelector('.error-message');
    if (!errorDiv) {
        errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        field.parentNode.appendChild(errorDiv);
    }
    errorDiv.textContent = `‚ö†Ô∏è ${message}`;
}

// Raccourcis clavier
document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + S pour sauvegarder
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        form.dispatchEvent(new Event('submit'));
    }
    
    // Escape pour annuler
    if (e.key === 'Escape') {
        if (confirm('Annuler les modifications ?')) {
            window.location.href = `/entreprises/<%= entreprise.id %>`;
        }
    }
});

console.log('Formulaire d\'√©dition entreprise charg√© - <%= entreprise.nom %>');
console.log('Licences utilis√©es: <%= entreprise.nombre_licences_utilisees %>/<%= entreprise.nombre_licences_max %>');
</script>