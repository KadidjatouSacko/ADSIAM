<% locals.currentPage = 'dashboard' %>

<!-- Stats cards -->
<div class="stats-grid">
    <div class="stat-card primary">
        <div class="stat-number"><%= stats.total_employes || 0 %></div>
        <div class="stat-label">Employ√©s</div>
    </div>
    <div class="stat-card success">
        <div class="stat-number"><%= stats.total_inscriptions || 0 %></div>
        <div class="stat-label">Inscriptions</div>
    </div>
    <div class="stat-card warning">
        <div class="stat-number"><%= stats.formations_terminees || 0 %></div>
        <div class="stat-label">Formations termin√©es</div>
    </div>
    <div class="stat-card info">
        <div class="stat-number"><%= stats.progression_moyenne || 0 %>%</div>
        <div class="stat-label">Progression moyenne</div>
    </div>
</div>

<!-- Actions rapides -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Actions rapides</h3>
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <a href="/entreprise/inscriptions/nouvelle" class="btn btn-primary" style="justify-self: start;">
                ‚ûï Nouvelle inscription
            </a>
            <a href="/entreprise/salaries" class="btn btn-secondary" style="justify-self: start;">
                üë• Voir mes salari√©s
            </a>
            <a href="/entreprise/rapports" class="btn btn-secondary" style="justify-self: start;">
                üìä G√©n√©rer un rapport
            </a>
            <a href="/entreprise/facturation" class="btn btn-secondary" style="justify-self: start;">
                üí∞ Facturation
            </a>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
    <!-- Activit√© r√©cente -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Activit√© r√©cente</h3>
            <a href="/entreprise/salaries" class="btn btn-secondary" style="font-size: 0.9rem; padding: 0.5rem 1rem;">
                Voir tout
            </a>
        </div>
        <div class="card-body">
            <% if (recentActivities && recentActivities.length > 0) { %>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <% recentActivities.slice(0, 5).forEach(activity => { %>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--soft-gray); border-radius: 8px;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 0.25rem;">
                                    <%= activity.prenom %> <%= activity.nom %>
                                </div>
                                <div style="color: var(--text-light); font-size: 0.9rem;">
                                    <%= activity.formation_titre %>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-<%= activity.statut === 'termine' ? 'success' : activity.statut === 'en_cours' ? 'info' : 'secondary' %>">
                                    <%= activity.statut %>
                                </span>
                                <div style="font-size: 0.8rem; color: var(--text-light); margin-top: 0.25rem;">
                                    <%= activity.progression_pourcentage %>%
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                    Aucune activit√© r√©cente
                </div>
            <% } %>
        </div>
    </div>

    <!-- Formations populaires -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Formations populaires</h3>
        </div>
        <div class="card-body">
            <% if (topFormations && topFormations.length > 0) { %>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <% topFormations.forEach(formation => { %>
                        <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--soft-gray); border-radius: 8px;">
                            <div style="font-size: 2rem; width: 50px; text-align: center;">
                                <%= formation.icone || 'üìö' %>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 0.25rem;">
                                    <%= formation.titre %>
                                </div>
                                <div style="color: var(--text-light); font-size: 0.9rem;">
                                    <%= formation.nb_inscriptions %> inscriptions
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600; color: var(--primary-blue);">
                                    <%= formation.progression_moyenne || 0 %>%
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-light);">
                                    Progression
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                    Aucune formation en cours
                </div>
            <% } %>
        </div>
    </div>
</div>

<!-- Graphiques de progression -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Vue d'ensemble des progressions</h3>
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
            <!-- Progression globale -->
            <div>
                <h4 style="margin-bottom: 1rem; color: var(--text-dark);">Progression globale</h4>
                <div style="background: var(--soft-gray); padding: 2rem; border-radius: 8px; text-align: center;">
                    <div style="font-size: 3rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 0.5rem;">
                        <%= stats.progression_moyenne || 0 %>%
                    </div>
                    <div style="color: var(--text-light);">Progression moyenne de vos √©quipes</div>
                </div>
            </div>

            <!-- Certifications -->
            <div>
                <h4 style="margin-bottom: 1rem; color: var(--text-dark);">Certifications obtenues</h4>
                <div style="background: var(--soft-gray); padding: 2rem; border-radius: 8px; text-align: center;">
                    <div style="font-size: 3rem; font-weight: 700; color: var(--success); margin-bottom: 0.5rem;">
                        <%= stats.certifications_obtenues || 0 %>
                    </div>
                    <div style="color: var(--text-light);">Attestations d√©livr√©es</div>
                </div>
            </div>

            <!-- Temps de formation -->
            <div>
                <h4 style="margin-bottom: 1rem; color: var(--text-dark);">Temps de formation</h4>
                <div style="background: var(--soft-gray); padding: 2rem; border-radius: 8px; text-align: center;">
                    <div style="font-size: 3rem; font-weight: 700; color: var(--warning); margin-bottom: 0.5rem;">
                        <%= Math.round((stats.temps_total || 0) / 60) %>h
                    </div>
                    <div style="color: var(--text-light);">Temps total investi</div>
                </div>
            </div>
        </div>
    </div>
</div>