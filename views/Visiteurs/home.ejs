<!-- views/visiteurs/home.ejs - Votre design adapt√© avec la BDD -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADSIAM | Formation Excellence Aide √† Domicile & EHPAD</title>
    <link rel="stylesheet" href="/css/home.css">
</head>

<style>
    .valeurs-section {
        margin: 12rem 0;
    }
    .valeurs-title {
        color: #d4a5a5;
        font-size: 2.2rem;
        font-weight: 400;
        margin-bottom: 2rem;
        text-align: center;
        letter-spacing: 0.02em;
    }
    .valeurs-grid {
        display: flex;
        gap: 2rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    .valeur-card {
        background: #fff;
        border-radius: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.06);
        padding: 2rem 2rem 1.5rem 2rem;
        flex: 1 1 280px;
        max-width: 350px;
        text-align: center;
        transition: box-shadow 0.3s;
    }
    .valeur-card:hover {
        box-shadow: 0 16px 40px rgba(0,0,0,0.12);
    }
    .valeur-icon {
        margin-bottom: 1rem;
    }
    .valeur-label {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 1rem;
    }
    .valeur-desc {
        font-size: 1rem;
        color: #7a7a7a;
    }
    @media (max-width: 900px) {
        .valeurs-grid {
            flex-direction: column;
            gap: 2rem;
            align-items: center;
        }
        .valeur-card {
            max-width: 100%;
        }
    }
</style>

<body>
    <!-- Top Bar -->
   

    <!-- Header -->
    <%- include('../partials/header') %>

    <main>
        <!-- Hero Section - STATS DYNAMIQUES -->
        <section class="hero">
            <div class="hero-container">
                <div class="hero-content fade-in">
                    <h1>FORMATION COMPL√àTE <span class="hero-highlight">AIDE √Ä DOMICILE & EHPAD</span></h1>
                    <p class="hero-subtitle">Communication, s√©curit√©, pratiques professionnelles</p>
                    <p class="hero-description">D√©veloppez vos comp√©tences avec notre formation compl√®te en <%= stats.totalFormations %> formations th√©matiques et <%= stats.totalModules %> modules interactifs. De la communication bienveillante aux gestes techniques, ma√Ætrisez tous les aspects de votre m√©tier.</p>
                    
                    <div class="hero-stats">
                        <div class="stat-item">
                            <span class="stat-number"><%= stats.totalModules %></span>
                            <span class="stat-label">Modules</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number"><%= stats.totalFormations %></span>
                            <span class="stat-label">Formations</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">24/7</span>
                            <span class="stat-label">Acc√®s</span>
                        </div>
                    </div>

                    <a href="/formations" class="hero-button">
                        üöÄ D√âCOUVRIR NOS FORMATIONS
                    </a>
                </div>
                <div class="hero-image slide-in-left">
                    <div class="image-placeholder">üéì</div>
                </div>
            </div>
        </section>

        <!-- Section NOS VALEURS - GARD√âE IDENTIQUE -->
        <section class="valeurs-section" style="margin: 4rem 0;">
            <h2 class="valeurs-title" style="color: #d4a5a5; margin-top: 20rem; font-size: 2.2rem; font-weight: 400; margin-bottom: 2rem; text-align: left;">
                NOS VALEURS
            </h2>
            <div style="display: flex; gap: 2rem; justify-content: center; text-align: center; margin-top: 8rem;">
                <div style="background: #e6f2f5; border-radius: 30px; padding: 2rem 2rem 1.5rem 2rem; flex: 1; text-align: center;">
                    <!-- Ic√¥ne PARTAGE SVG -->
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" style="margin-bottom:1rem;">
                        <circle cx="30" cy="30" r="28" fill="#e6f2f5"/>
                        <path d="M20 32c0-4 3-7 7-7s7 3 7 7c0 2-1 4-3 5l-4 3-4-3c-2-1-3-3-3-5z" stroke="#a5c9d4" stroke-width="2" fill="none"/>
                        <path d="M30 25v-3a5 5 0 0 1 10 0v3" stroke="#a5c9d4" stroke-width="2" fill="none"/>
                    </svg>
                    <h3 style="color: #a5c9d4; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">LE PARTAGE</h3>
                    <p style="color: #a5c9d4; font-size: 1rem;">
                        Le partage d'exp√©riences avec le formateur et l'ensemble du groupe permet la prise de recul, l'analyse de sa propre pratique, l'enrichissement de sa comp√©tence et le d√©veloppement de nouveaux savoir-faire.
                    </p>
                </div>
                <div style="background: #edeaf3; border-radius: 30px; padding: 2rem 2rem 1.5rem 2rem; flex: 1; text-align: center;">
                    <!-- Ic√¥ne COMP√âTENCE SVG -->
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" style="margin-bottom:1rem;">
                        <circle cx="30" cy="30" r="28" fill="#edeaf3"/>
                        <path d="M30 20a10 10 0 1 1-10 10" stroke="#b6b1c9" stroke-width="2" fill="none"/>
                        <rect x="28" y="32" width="4" height="10" rx="2" fill="#b6b1c9"/>
                        <circle cx="30" cy="30" r="3" fill="#b6b1c9"/>
                    </svg>
                    <h3 style="color: #b6b1c9; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">LE D√âVELOPPEMENT DE SA COMP√âTENCE</h3>
                    <p style="color: #b6b1c9; font-size: 1rem;">
                        Les dispositifs et les techniques de soins √©voluent √† grande vitesse. Ma√Ætriser les connaissances et les savoir-faire, permet d'assurer une prise en charge de qualit√© et de valoriser la comp√©tence du soignant.
                    </p>
                </div>
                <div style="background: #f5e6e6; border-radius: 30px; padding: 2rem 2rem 1.5rem 2rem; flex: 1; text-align: center;">
                    <!-- Ic√¥ne √âPANOUISSEMENT SVG -->
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" style="margin-bottom:1rem;">
                        <circle cx="30" cy="30" r="28" fill="#f5e6e6"/>
                        <path d="M30 40c8-8 8-16 0-24-8 8-8 16 0 24z" stroke="#d4a5a5" stroke-width="2" fill="none"/>
                        <ellipse cx="30" cy="32" rx="8" ry="4" stroke="#d4a5a5" stroke-width="2" fill="none"/>
                    </svg>
                    <h3 style="color: #d4a5a5; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">L'√âPANOUISSEMENT</h3>
                    <p style="color: #d4a5a5; font-size: 1rem;">
                        Chaque participant a des attentes et des besoins. Le formateur mod√®re les enseignements de sorte √† ce que tous les participants puissent atteindre les objectifs qu'ils se sont fix√©s.
                    </p>
                </div>
            </div>
        </section>

        <!-- FORMATIONS SECTION - MAINTENANT DYNAMIQUE -->
        <section class="public-section">
            <div class="public-container">
                <h2 class="section-title">NOS FORMATIONS</h2>
                <div class="formations-intro">
                    <p>D√©couvrez notre catalogue de formations sp√©cialis√©es pour les professionnels de l'aide √† domicile et des EHPAD. Chaque module combine th√©orie, pratique et mise en situation r√©elle.</p>
                </div>
                
                <div class="formations-grid">
                    <!-- BOUCLE SUR LES FORMATIONS DE LA BDD -->
                    <% formations.forEach((formation, index) => { %>
                    <div class="formation-card fade-in" data-formation-id="<%= formation.id %>">
                        <div class="formation-header">
                            <div class="formation-icon"><%= formation.icone %></div>
                            <% if (formation.badge) { %>
                            <div class="formation-badge"><%= formation.badge %></div>
                            <% } %>
                        </div>
                        <div class="formation-content">
                            <div class="formation-meta">
                                <span class="meta-tag modules-tag"><%= formation.nombre_modules %> modules</span>
                                <span class="meta-tag level-tag"><%= formation.niveau.charAt(0).toUpperCase() + formation.niveau.slice(1) %></span>
                                <% if (formation.nombreAvis > 0) { %>
                                <span class="meta-tag">‚≠ê <%= formation.noteMoyenne %>/5</span>
                                <% } %>
                            </div>
                            <h3 class="formation-title"><%= formation.titre %></h3>
                            <p class="formation-description"><%= formation.description %></p>
                            <div class="formation-features">
                                <!-- CARACT√âRISTIQUES DYNAMIQUES -->
                                <% formation.caracteristiques.slice(0, 4).forEach(carac => { %>
                                <div class="feature-item">
                                    <span class="feature-icon"><%= carac.icone %></span>
                                    <span><%= carac.titre %></span>
                                </div>
                                <% }); %>
                            </div>
                            <div class="formation-footer">
                                <!-- PRIX DYNAMIQUE -->
                                <div class="formation-price">
                                    <% if (formation.gratuit) { %>
                                    Gratuit
                                    <% } else { %>
                                    <%= Math.floor(formation.prix) %>‚Ç¨
                                    <% } %>
                                </div>
                                <button class="formation-btn" onclick="redirectToFormation(<%= formation.id %>)">Commencer</button>
                            </div>
                        </div>
                    </div>
                    <% }); %>
                </div>
            </div>
        </section>

        <!-- Stats Section - STATS DYNAMIQUES -->
        <section class="stats-section">
            <div class="stats-container">
                <div class="stats-grid">
                    <div class="stat-card fade-in">
                        <span class="stat-number"><%= stats.professionnelsFormes.toLocaleString() %>+</span>
                        <span class="stat-label">Professionnels form√©s</span>
                    </div>
                    <div class="stat-card fade-in">
                        <span class="stat-number"><%= stats.totalModules %></span>
                        <span class="stat-label">Modules interactifs</span>
                    </div>
                    <div class="stat-card fade-in">
                        <span class="stat-number"><%= stats.tauxSatisfaction %>%</span>
                        <span class="stat-label">Taux de satisfaction</span>
                    </div>
                    <div class="stat-card fade-in">
                        <span class="stat-number">24/7</span>
                        <span class="stat-label">Support disponible</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="cta-container">
                <h2 class="cta-title">Pr√™t √† <span class="cta-highlight">d√©velopper vos comp√©tences</span> ?</h2>
                <p class="cta-description">Rejoignez plus de <%= stats.professionnelsFormes.toLocaleString() %> professionnels qui ont d√©j√† fait confiance √† ADSIAM pour leur d√©veloppement professionnel. Acc√©dez √† nos formations d√®s aujourd'hui.</p>
                <div class="cta-buttons">
                    <a href="/formations" class="cta-button">
                        üöÄ Commencer maintenant
                    </a>
                    <a href="/contact" class="cta-button secondary">
                        üí¨ Nous contacter
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <%- include('../partials/footer') %>

    <!-- Chat Widget -->
    <div class="chat-widget">
        <div class="chat-button" title="Besoin d'aide ? Chattez avec nous !">
            üí¨
            <div class="chat-notification">1</div>
        </div>
    </div>

    <script>
        // FONCTION POUR REDIRECTION DYNAMIQUE VERS FORMATION
        function redirectToFormation(formationId) {
            window.location.href = `/formations/${formationId}`;
        }

        // Smooth scrolling pour les liens
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Animation au scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    if (entry.target.classList.contains('slide-in-left')) {
                        entry.target.style.animation = 'slideInLeft 0.8s ease forwards';
                    } else {
                        entry.target.style.animation = 'fadeInUp 0.8s ease forwards';
                    }
                }
            });
        }, observerOptions);

        // Observer tous les √©l√©ments avec animation
        document.querySelectorAll('.fade-in, .slide-in-left').forEach(el => {
            observer.observe(el);
        });

        // Animation des compteurs dans les stats - VALEURS DYNAMIQUES
        function animateCounter(element, target) {
            let count = 0;
            const targetNum = parseInt(target.replace(/[^\d]/g, ''));
            const increment = targetNum / 50;
            
            const timer = setInterval(() => {
                count += increment;
                if (count >= targetNum) {
                    element.textContent = target;
                    clearInterval(timer);
                } else {
                    if (target.includes('%')) {
                        element.textContent = Math.floor(count) + '%';
                    } else if (target.includes('+')) {
                        element.textContent = Math.floor(count).toLocaleString() + '+';
                    } else if (target.includes('/')) {
                        element.textContent = target;
                    } else {
                        element.textContent = Math.floor(count).toLocaleString();
                    }
                }
            }, 50);
        }

        // Observer les stats pour l'animation des compteurs
        const statsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.classList.contains('animated')) {
                    entry.target.classList.add('animated');
                    const statNumber = entry.target.querySelector('.stat-number');
                    if (statNumber) {
                        const target = statNumber.textContent;
                        statNumber.textContent = '0';
                        setTimeout(() => animateCounter(statNumber, target), 500);
                    }
                }
            });
        });

        document.querySelectorAll('.stat-card').forEach(el => {
            statsObserver.observe(el);
        });

        // Interaction des cartes de formation - LIENS DYNAMIQUES
        document.querySelectorAll('.formation-card').forEach(card => {
            card.addEventListener('click', (e) => {
                if (!e.target.classList.contains('formation-btn')) {
                    const formationId = card.dataset.formationId;
                    window.location.href = `/formations/${formationId}`;
                }
            });
        });

        // Boutons de formation - LOGIQUE AM√âLIOR√âE
        document.querySelectorAll('.formation-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.stopPropagation();
                const card = e.target.closest('.formation-card');
                const title = card.querySelector('.formation-title').textContent;
                const price = card.querySelector('.formation-price').textContent;
                const formationId = card.dataset.formationId;
                
                if (price === 'Gratuit' || price === '0‚Ç¨') {
                    alert(`üéâ F√©licitations !\n\nAcc√®s imm√©diat √† la formation :\n"${title}"\n\nüöÄ Redirection vers le contenu...`);
                    // Redirection vers la formation
                    window.location.href = `/formations/${formationId}`;
                } else {
                    alert(`üí≥ Formation : ${title}\nPrix : ${price}\n\nüõí Redirection vers la page de la formation...`);
                    window.location.href = `/formations/${formationId}`;
                }
            });
        });

        // Widget de chat
        document.querySelector('.chat-button').addEventListener('click', () => {
            // Supprimer la notification
            const notification = document.querySelector('.chat-notification');
            if (notification) {
                notification.remove();
            }
            
            // Message de chat
            alert('üí¨ Chat en direct avec ADSIAM\n\nüëã Bonjour ! Comment pouvons-nous vous aider ?\n\n‚úÖ Questions sur les formations\n‚úÖ Support technique\n‚úÖ Informations tarifaires\n‚úÖ Conseils personnalis√©s\n\nNotre √©quipe r√©pond en quelques minutes !');
        });

        // Header scroll effect
        let lastScrollTop = 0;
        const header = document.querySelector('header');

        window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > 100) {
                header.style.boxShadow = '0 5px 30px rgba(0,0,0,0.15)';
            } else {
                header.style.boxShadow = '0 2px 20px rgba(0,0,0,0.08)';
            }
        });

        // Message de bienvenue au chargement
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üöÄ ADSIAM - Plateforme de formation charg√©e avec succ√®s !');
                console.log(`üìö ${<%= stats.totalModules %>} modules de formation disponibles`);
                console.log(`üë• Rejoignez plus de ${<%= stats.professionnelsFormes %>} professionnels d√©j√† form√©s`);
            }, 1000);
        });

        // Effet parallaxe l√©ger sur le hero
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const hero = document.querySelector('.hero');
            if (hero) {
                hero.style.transform = `translateY(${scrolled * 0.2}px)`;
            }
        });
    </script>
</body>
</html>